#include "config.h"
#include <gtest/gtest.h>

#include "certificate.h"

namespace rgw::h3 {

static constexpr std::string_view cert = R"(
-----BEGIN CERTIFICATE-----
MIIFZTCCA02gAwIBAgIUBZpk+5o0/k64pVaq4MucTv033skwDQYJKoZIhvcNAQEL
BQAwQjELMAkGA1UEBhMCWFgxFTATBgNVBAcMDERlZmF1bHQgQ2l0eTEcMBoGA1UE
CgwTRGVmYXVsdCBDb21wYW55IEx0ZDAeFw0yMzAyMjQxODU2NTZaFw0yNDAyMjQx
ODU2NTZaMEIxCzAJBgNVBAYTAlhYMRUwEwYDVQQHDAxEZWZhdWx0IENpdHkxHDAa
BgNVBAoME0RlZmF1bHQgQ29tcGFueSBMdGQwggIiMA0GCSqGSIb3DQEBAQUAA4IC
DwAwggIKAoICAQDDBe3zkCAtzsffhnsxZy0MGduabIKp+ESdRwh+AF8MxhiGUEJw
jIpf96ql+kTa3+SuFEtfneyJXf4ErUelfgGzkYni4aZgiqT1gvs3AGg+nAJoirLG
Yj+eH+ycQEYlTpq4+Wy2eXNufQUbxZcDEmF08Ttzg95CFPsyi3h1HvUYTIkiuYor
YMFcd3S5SS0e31EFXrhYNcCgIC8KNbti/25Hb6/8BrkcgKtDwkfBmope5XzlefYH
Tg3hrEWZ48IOHKdknvIpQX87zysSZHamzgLrvOc77OQ+6hEDhlZ5di5bwCyktWby
/BS8c8/yGipNPmbAa4P3B5TxO6BZPNp0BFcIGwAKhVuVYxaJrJWUO3EQarCWLE41
pDkeQBqxDsiUr58paeH9afqLpxPmF4A4lr5mCPeuVp8elgbGzngccAdUqy5/eEv0
Tim50aQCnCy+fJ67NOHN+bN8u3KGaXPcnyAXPrn21+D/VD3gbycutInGmhpYuc/i
1dP8FVITr7s5U1x+2lROXM2tM/2AEayChKTFylmwtMprSfDfc3h1+rgpjEPiMSh9
oV1Qr3Tua4zmth0X04JxwgItZRh1MfY1N2qt8xMU0+QxxGG0DmiSpKaGEktwNZw9
nBaHReijaxtnpWuX8E8Y+EQClo30q/88eFWpQjhB7jLK3HUxmrnhaYU36wIDAQAB
o1MwUTAdBgNVHQ4EFgQUUE5TcKcMMBdz7oysBZNxl7rG6GYwHwYDVR0jBBgwFoAU
UE5TcKcMMBdz7oysBZNxl7rG6GYwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0B
AQsFAAOCAgEAQtyFc80TPkgEhy2I5c1gqnyPznV5G/vij7/sf9Pq+AG1cSIFxo/D
gHgL4g/w87wcQMshe4jQhbDwTPmzdWb6uVP8DHHM4WWEeqG7P4sLlwLWb5GYRh7X
GMJQUGpK2QPt8lwzOj5vrAPIaWU1+5aqSbFPAhyexnWmxwHSDizbYAOD7/xVzEmy
4BD9UJV2f3JPDJ8uNRCBFfovqVG7e35CUvdx1FUPl6jNkAtFeR4Gulniaku8uoB+
USoNeJPotvukZd9hIg8ixEOgtM+mOnuoMfT+lAAonbAJpS3viA4xiGPiLJzcm9w4
kVI2Yq7wBXGK4bv1ZxiUzAQeRdRKaSxuY8tHTtgzl9fh+V8lu9z4muu20ynEaXuz
Qyabt+Xr1IaFVJvZo4bk4mun+I/i71+k6rQzwSXoNveIMw7dFLCn+civ01uInIFO
sCOPNVh6/cL4gu0IR03c45UDFrsIxgNFsja3kVhHceSf2XxLg19+5iic6AIPip4W
5rxM9XDNxT0/KCYpyquObcEE4yustoFpPvtIcaMT564nSAxKIzcSiTRlCCiSPeQr
4Uqb/oNndzjHi2cpqPBe27FhT5bc8vSJY0/yzbWJZfv7ZdduxwgUTmUVL+cHLSyS
dFtb5yLlmCiMlI6bXW705fF0RIPG7lhb3YcyzLUduxE2p/ONexli32c=
-----END CERTIFICATE-----)";

static constexpr std::string_view key = R"(
-----BEGIN PRIVATE KEY-----
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
Q1aYTsIzh4Isku9C2XBQ8MtfjXsa1MY=
-----END PRIVATE KEY-----)";

TEST(h3, config)
{
  Options o;
  o.ssl_certificate = pem_data{cert};
  o.ssl_private_key = pem_data{key};

  auto cfg = create_h3_config(o);
}

} // namespace rgw::h3
